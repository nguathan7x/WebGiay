@model WebGiayOnline.Models.Giay
@using System.Globalization
@{
    var discount = ViewData["Discount"] as WebGiayOnline.Models.Discount;
    decimal finalPrice = Model.Price;
    if (discount != null)
    {
        finalPrice = Model.Price * (1 - discount.Percentage / 100);
    }
}

<div class="col">
    <div class="card h-100 shadow-sm border-0">
        <div class="position-relative">
            <img src="@Model.ImageUrl" class="card-img-top" alt="@Model.Name" style="height: 300px; object-fit: cover;">
            @if (discount != null)
            {
                @* <span class="discount-sticker">Giảm -@discount.Percentage%</span> *@
                <div class="ribbon"><span>-@discount.Percentage% OFF</span></div>
               @*  <span class="badge-sale position-absolute top-0 start-0 m-2 px-3 py-2">
                    -@discount.Percentage%
                </span> *@
            }
        </div>
       @*  <div class="sale-image-wrapper">
            <img src="@Model.ImageUrl" class="card-img-top product-img" alt="@Model.Name">
            @if (discount != null)
            {
                <div class="discount-circle">-@discount.Percentage%</div>
            }
        </div> *@
        <div class="card-body d-flex flex-column">
            <h5 class="card-title text-truncate">@Model.Name</h5>
            @if (discount != null)
            {
                <p class="mb-0 text-muted"><del>@Model.Price.ToString("C0", CultureInfo.GetCultureInfo("vi-VN"))</del></p>
                <p class="text-danger fw-bold mb-3">@finalPrice.ToString("C0", CultureInfo.GetCultureInfo("vi-VN"))</p>
            }
            else
            {
                <p class="text-muted fw-bold mb-3">@Model.Price.ToString("C0", CultureInfo.GetCultureInfo("vi-VN"))</p>
            }

            <div class="mt-auto d-flex gap-2">
                <a asp-controller="Product" asp-action="Details" asp-route-id="@Model.GiayId" class="btn btn-dark w-100">
                    View Details
                </a>
                <form method="post" asp-action="ToggleFavorite" asp-controller="Favorite" class="w-100">
                    <input type="hidden" name="giayId" value="@Model.GiayId" />
                    <button type="submit" class="btn btn-outline-danger w-100">Remove</button>
                </form>
            </div>
        </div>
    </div>
</div>
<style>
    .badge-sale {
        background-color: red;
        color: white;
        font-weight: bold;
        font-size: 0.9rem;
        border-radius: 0.25rem;
        z-index: 10;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }

    .ribbon {
        width: 150px;
        height: 150px;
        overflow: hidden;
        position: absolute;
        top: -10px;
        left: -10px;
    }

        .ribbon span {
            position: absolute;
            display: block;
            width: 225px;
            padding: 10px 0;
            background: red;
            color: white;
            text-align: center;
            font-weight: bold;
            transform: rotate(-45deg);
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
            top: 30px;
            left: -40px;
        }

    .discount-sticker {
        position: absolute;
        top: 15px;
        left: 15px;
        background: linear-gradient(to right, #f12711, #f5af19);
        color: white;
        padding: 5px 12px;
        font-size: 0.85rem;
        font-weight: bold;
        border-radius: 25px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        z-index: 5;
    }

    .sale-image-wrapper {
        position: relative;
        overflow: hidden;
        border-radius: 10px;
    }

        .sale-image-wrapper img.product-img {
            transition: transform 0.3s ease-in-out;
        }

        .sale-image-wrapper:hover img.product-img {
            transform: scale(1.05);
        }

    .discount-circle {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: crimson;
        color: white;
        font-size: 0.9rem;
        padding: 8px 10px;
        border-radius: 50%;
        font-weight: bold;
        box-shadow: 0 3px 6px rgba(0,0,0,0.2);
    }

</style>
@* <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
    @foreach (var fav in Model)
    {
        @await Component.InvokeAsync("GiayCard", fav.Giay)
    }
</div> *@
